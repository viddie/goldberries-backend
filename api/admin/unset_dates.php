<?php

require_once('../api_bootstrap.inc.php');

if ($_SERVER['REQUEST_METHOD'] !== 'GET') {
  die_json(405, 'Method Not Allowed');
}

$account = get_user_data();
check_access($account, false);
if (!is_admin($account)) {
  die_json(403, 'Not authorized');
}

//Set content type to plain text
header('Content-Type: text/plain');


$submission_ids = [
  42172,
  42173,
  42174,
  42175,
  42176,
  42177,
  42178,
  42179,
  42180,
  42181,
  42182,
  42183,
  42184,
  42185,
  42186,
  42187,
  42188,
  42189,
  42190,
  42191,
  42192,
  42193,
  42194,
  42195,
  42196,
  42197,
  42198,
  42199,
  42200,
  42201,
  42202,
  42203,
  42204,
  42205,
  42206,
  42207,
  42208,
  42209,
  42210,
  42211,
  42212,
  42213,
  42214,
  42215,
  42216,
  42217,
  42218,
  42219,
  42220,
  42221,
  42222,
  42223,
  42224,
  42225,
  42226,
  42227,
  42228,
  42229,
  42231,
  42233,
  42234,
  42235,
  42237,
  42263,
  42266,
  42267,
  42268,
  42269,
  42270,
  42271,
  42272,
  42273,
  42274,
  42275,
  42276,
  42277,
  42278,
  42279,
  42280,
  42281,
  42282,
  42283,
  42285,
  42286,
  42287,
  42288,
  42289,
  42290,
  42291,
  42292,
  42470,
  42471,
  42472,
  42473,
  42474,
  42475,
  42476,
  42477,
  42478,
  42479,
  42480,
  42481,
  42482,
  42483,
  42485,
  42486,
  42487,
  42489,
  42491,
  42492,
  42493,
  42494,
  42495,
  42496,
  42497,
  42498,
  42499,
  42500,
  42503,
  42470,
  42471,
  42472,
  42473,
  42474,
  42475,
  42476,
  42477,
  42478,
  42479,
  42480,
  42481,
  42482,
  42483,
  42485,
  42486,
  42487,
  42489,
  42491,
  42492,
  42493,
  42494,
  42495,
  42496,
  42497,
  42498,
  42499,
  42500,
  42503,
  42517,
  42520,
  42522,
  42525,
  42526,
  42528,
  42530,
  42533,
  42534,
  42536,
  42451,
  42542,
  42543,
  42544,
  42545,
  42546,
  42547,
  42548,
  42556,
  42558,
  42561,
  42563,
  42564,
  42567,
  42570,
  42572,
  42573,
  42579,
  42582,
  42584,
  42587,
  42590,
  42592,
  42593,
  42596,
  42599,
  42602,
  42605,
  42607,
  42609,
  42611,
  42617,
  42619,
  42622,
  42625,
  42640,
  42642,
  42644,
  42646,
  42648,
  42650,
  42653,
  42655,
  42657,
  42661,
  42664,
  42665,
  42512,
  42513,
  42514,
  42515,
  42516,
  42518,
  42519,
  42521,
  42523,
  42524,
  42527,
  42529,
  42531,
  42532,
  42535,
  42537,
  42538,
  42540,
  42549,
  42550,
  42551,
  42552,
  42553,
  42554,
  42555,
  42557,
  42559,
  42560,
  42562,
  42565,
  42566,
  42568,
  42569,
  42571,
  42574,
  42575,
  42576,
  42577,
  42578,
  42580,
  42581,
  42583,
  42585,
  42586,
  42588,
  42589,
  42591,
  42594,
  42595,
  42597,
  42598,
  42600,
  42601,
  42603,
  42604,
  42606,
  42608,
  42610,
  42612,
  42613,
  42614,
  42615,
  42616,
  42618,
  42620,
  42621,
  42623,
  42624,
  42626,
  42628,
  42629,
  42630,
  42631,
  42632,
  42633,
  42634,
  42635,
  42636,
  42637,
  42638,
  42639,
  42641,
  42643,
  42645,
  42647,
  42649,
  42651,
  42652,
  42656,
  42658,
  42659,
  42660,
  42662,
  42663,
  42676,
  42677,
  42678,
  42685,
  42686,
  42687,
  42686,
  42689,
  42690,
  42691,
  42692,
  42693,
  42694,
  42695,
  42696,
  42697,
  42698,
  42699,
  42700,
  42702,
  42704,
  42705,
  42706,
  42707,
  42708,
  42709,
  42710,
  42711,
  42844,
  42846,
  42847,
  42848,
  42849,
  42850,
  42851,
  42852,
  42853,
  42854,
  42855,
  42856,
  42857,
  42858,
  42859,
  42860,
  42861,
  42863,
  42865,
  42867,
  42869,
  42870,
  42871,
  42872,
  42873,
  42874,
  42876,
  42877,
  42879,
  42880,
  42888,
  42890,
  42892,
  42893,
  42894,
  42895,
  42896,
  42897,
  42898,
  42899,
  42900,
  42901,
  42902,
  42903,
  42904,
  42906,
  42908,
  42909,
  42911,
  42912,
  42913,
  42920,
  42922,
  42923,
  42926,
  42930,
  42932,
  42933,
  42934,
  42935,
  42939,
  42940,
  42941,
  42942,
  42959,
  42961,
  42962,
  42862,
  42864,
  42866,
  42868,
  42878,
  42881,
  42882,
  42883,
  42884,
  42886,
  42887,
  42889,
  42891,
  42905,
  42907,
  42910,
  42914,
  42915,
  42917,
  42918,
  42919,
  42924,
  42925,
  42927,
  42928,
  42929,
  42943,
  42944,
  42945,
  42946,
  42947,
  42948,
  42949,
  42950,
  42951,
  42952,
  42953,
  42954,
  42955,
  42956,
  42958,
  42960,
  42964,
  42965,
  42966,
  42967,
  42968,
  42969,
  42970,
  42971,
  42972,
  42974,
  42975,
  42976,
  42977,
  42978,
  42979,
  42980,
  42981,
  42982,
  42983,
  42986,
  42987,
  42988,
  42989,
  42990
];

//Loop through submission ids, get the submission and set the date_created to NULL
echo "Starting processing\n\n";

$i = 0;
foreach ($submission_ids as $submission_id) {
  $i++;
  $submission = Submission::get_by_id($DB, $submission_id);
  if ($submission === false) {
    echo "Error fetching submission #{$i}: $submission_id\n";
    continue;
  }
  $submission->date_created = null;
  if ($submission->update($DB) === false) {
    echo "Error updating submission #{$i}: $submission_id\n";
  } else {
    echo "Submission #{$i}: $submission_id updated\n";
  }
}

echo "\nFinished processing {$i} submissions.\n";